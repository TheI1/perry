<!DOCTYPE html><html><head><title>Perry Perry Perry</title><script>var users={target:{src:"",src_element:null,admin_names:[],auth_user_names:[],all_user_names:[],debug_text:null,entred:!1},test:{cmd_element:null,admin_element:null,cmd_result:"",names:[],names_out:null,admins:[],admins_out:null},name_diff:null,admin_diff:null,to_remove:[],to_lower:[],to_higher:[],passwords:{},pass_btn:null,curr_usr:"",needed:[]};function copy_usr_cmd(e){navigator.clipboard.writeText("net users")}function copy_admin_cmd(e){navigator.clipboard.writeText("net localgroup administrators")}function copy_pass(){navigator.clipboard.writeText(users.passwords[users.curr_usr])}function load(){setInterval(check,50),users.target.src_element=document.getElementById("in_users"),users.target.debug_text=document.getElementById("debug_text"),users.test.cmd_element=document.getElementById("cmd_src"),users.test.admin_element=document.getElementById("cmd_src_admin"),users.test.names_out=document.getElementById("cmd-names-out"),users.test.admins_out=document.getElementById("cmd-admins-out"),users.admin_diff=document.getElementById("admin-diff"),users.name_diff=document.getElementById("name-diff"),users.pass_btn=document.getElementById("copy-pass-btn")}function check(){check_target(users.target),users.pass_btn.value=`Copy Password For: ${users.curr_usr}`,check_cmd_out(users.test),catigorize_usrs(),users.admin_diff.innerText=`TO PROMOTE:${users.to_higher.join(" ")};TO DEMOTE:${users.to_lower.join(" ")}`,users.name_diff.innerText=`TO DELETE:${users.to_remove.join(" ")};TO ADD:${users.needed.join(" ")}`,create_cmds()}function catigorize_usrs(){users.to_remove=users.test.names.filter(e=>!users.target.all_user_names.includes(e)),users.needed=users.target.all_user_names.filter(e=>!users.test.names.includes(e)),users.to_higher=users.target.admin_names.filter(e=>!users.test.admins.includes(e)),users.to_lower=users.test.admins.filter(e=>!users.target.admin_names.includes(e))}function create_cmds(){let e="echo.";for(let n in users.to_higher)e+=` & net localgroup administrators /add ${users.to_higher[n]}`;for(let n in users.to_lower)e+=` & net localgroup administrators /delete ${users.to_lower[n]}`;for(let n in users.to_remove)e+=` & net user /delete ${users.to_remove[n]}`,e+=` & rmdir C:\\users\\${users.to_remove[n]} /s /q`;users.test.cmd_result=e}function check_cmd_out(e){e.names=extract_user_from_net(e.cmd_element.value),e.names_out.innerText="users: "+e.names.join(", "),e.admins=extract_user_from_net(e.admin_element.value),e.admins_out.innerText="admins: "+e.admins.join(", ")}function extract_user_from_net(e){for(var n=[],r=e.split(`;`);r.length&&!r[0].trim().replaceAll("-","");)r.splice(0,1);for(let i in r){if(r[i].toLowerCase().trim()=="the command completed successfully.".substring(0,r[i].length))break;var t=r[i].slice(0,24).trim();t&&n.push(t);var t=r[i].slice(25,49).trim();t&&n.push(t);var t=r[i].slice(50).trim();t&&n.push(t)}let a=[];for(let i in n)["WDAGUtilityAccount","Administrator","DefaultAccount","Guest"].includes(n[i])||a.push(n[i]);return a}function change_cmd(e){return e.cmd_element.value!=e.cmd_result?(e.cmd_result=e.cmd_element.value,!0):!1}function check_target(e){change_src(e)&&parse_target(e,users.passwords)}function change_src(e){let n=e.src_element.value;return e.src==n?!1:(e.src=n,console.log("val changed"),!0)}function parse_target(e,n){var r=e.src,t=r.split(`;`);let a="password:",i="authorized administrators:",o;console.log(t);let l=0;for(;l<t.length;){let s=t[l].trim(),u=s.toLowerCase(),m;s.includes(a)?([s,m]=s.split(a,2),s=s.trim(),m=m.trim(),s?(n[s]=m,t[l]=s,l++):(n[t[l-1]]=m,t.splice(l,1))):u.includes("authorized users:")?(t.splice(l,1),o=l-1):u==i.slice(i.length-u.length)?t.splice(l,1):s&&(s.endsWith("(you)")&&(s=s.substring(0,s.length-6).trim(),users.curr_usr=s),t[l]=s,l++)}var d=t.slice(0,o),c=t.slice(o,-1);e.entered=!!t,debug_msg(e.debug_text,"Auth Users: "+c.join(", ")+`;Admins: `+d.join(", ")),e.admin_names=d,e.auth_user_names=c,e.all_user_names=t}function debug_msg(e,n){e.innerText=n};</script><style>.middle_row{width:33%;text-align:center;vertical-align:top}.main_table{width:100%}.diff{color:green}#in_users,#cmd_src,#cmd_src_admin{width:100%;height:12rem}#debug_text,#cmd-names-out,#cmd-admins-out{color:red}.cmd_cp{background-color:#d3d3d3;width:max-content;display:inline}</style></head><body onload="load()"><table class="main_table"><tr><td class="middle_row">SOURCE (the list of users from the README file) <br><textarea id="in_users"></textarea> <br><div id="debug_text"></div> <br><input id="copy-pass-btn" onclick="copy_pass()" type="button"></td><td class="middle_row"><div>result of <div class="cmd_cp">net users</div>: <input type="button" value="copy command" onclick="copy_usr_cmd()"></div><textarea id="cmd_src"></textarea> <br><div id="cmd-names-out"></div><div id="name-diff" class="diff"></div></td><td class="middle_row"><div>result of <div class="cmd_cp">net localgroup administrators</div>: <input type="button" value="copy command" onclick="copy_admin_cmd()"></div><textarea id="cmd_src_admin"></textarea> <br><div id="cmd-admins-out"></div><div id="admin-diff" class="diff"></div></td></tr></table></body></html>