<!DOCTYPE html><html><head><title>Perry Perry Perry</title><script>var users = {target: {src: "",src_element: null,admin_names: [],auth_user_names: [],all_user_names: [],debug_text: null,entred: false},test: {cmd_element: null,admin_element: null,cmd_result: "",names: [],names_out: null,admins: [],admins_out: null},name_diff: null,admin_diff: null,to_remove: [],to_lower: [],to_higher: [],passwords: {},pass_btn: null,curr_usr: "",needed: []};function copy_usr_cmd(text) {navigator.clipboard.writeText("net users");};function copy_admin_cmd(text) {navigator.clipboard.writeText("net localgroup administrators");};function copy_pass() {navigator.clipboard.writeText(users.passwords[users.curr_usr]);};function load() {setInterval(check, 50);users.target.src_element = document.getElementById("in_users");users.target.debug_text = document.getElementById("debug_text");users.test.cmd_element = document.getElementById("cmd_src");users.test.admin_element = document.getElementById("cmd_src_admin");users.test.names_out = document.getElementById("cmd-names-out");users.test.admins_out = document.getElementById("cmd-admins-out");users.admin_diff = document.getElementById("admin-diff");users.name_diff = document.getElementById("name-diff");users.pass_btn = document.getElementById("copy-pass-btn");};function check() {check_target(users.target);users.pass_btn.value = `Copy Password For: ${users.curr_usr}`;check_cmd_out(users.test);catigorize_usrs();users.admin_diff.innerText = `TO PROMOTE:\n${users.to_higher.join(" ")}\n\nTO DEMOTE:\n${users.to_lower.join(" ")}`;users.name_diff.innerText = `TO DELETE:\n${users.to_remove.join(" ")}\n\nTO ADD:\n${users.needed.join(" ")}`;create_cmds();};function catigorize_usrs() {users.to_remove = users.test.names.filter(x => !users.target.all_user_names.includes(x));users.needed = users.target.all_user_names.filter(x => !users.test.names.includes(x));users.to_higher = users.target.admin_names.filter(x => !users.test.admins.includes(x));users.to_lower = users.test.admins.filter(x => !users.target.admin_names.includes(x));};function create_cmds() {};function check_cmd_out(test) {test.names = extract_user_from_net(test.cmd_element.value);test.names_out.innerText = "users: " + test.names.join(", ");test.admins = extract_user_from_net(test.admin_element.value);test.admins_out.innerText = "admins: " + test.admins.join(", ");};function extract_user_from_net(out) {var usrs = [];var lines = out.split("\n");while (lines.length && !lines[0].trim().replaceAll("-", "")) {lines.splice(0, 1);};for (let line in lines) {if (lines[line].toLowerCase().trim() == "the command completed successfully.".substring(0, lines[line].length)) {break;};var name = lines[line].slice(0, 24).trim();if (name) {usrs.push(name);};var name = lines[line].slice(25, 49).trim();if (name) {usrs.push(name);};var name = lines[line].slice(50).trim();if (name) {usrs.push(name);};};let final = [];for (let usr in usrs) {if (!["WDAGUtilityAccount", "Administrator", "DefaultAccount", "Guest"].includes(usrs[usr])) {final.push(usrs[usr]);};};return final;};function change_cmd(test) {if (test.cmd_element.value != test.cmd_result) {test.cmd_result = test.cmd_element.value;return true;};return false;};function check_target(target) {if (change_src(target)) {parse_target(target, users.passwords);};};function change_src(target) {let val = target.src_element.value;if (target.src == val) {return false;} else {target.src = val;console.log("val changed");return true;};};function parse_target(target, passwords) {var src = target.src;var names = src.split("\n");let pass_header = "password:";let admin_header = "authorized administrators:";let split;console.log(names);let i = 0;while (i < names.length) {let name = names[i].trim();let lo = name.toLowerCase();let passwd;if (name.includes(pass_header)) {[name, passwd] = name.split(pass_header, 2);name = name.trim();passwd = passwd.trim();if (name) {passwords[name] = passwd;names[i] = name;i++;} else {passwords[names[i-1]] = passwd;names.splice(i, 1);};} else if (lo.includes("authorized users:")) {names.splice(i, 1);split = i - 1;} else if (lo == admin_header.slice(admin_header.length - lo.length)) {names.splice(i, 1);} else if (name) {if (name.endsWith("(you)")) {name = name.substring(0, name.length - 6).trim();users.curr_usr = name;};names[i] = name;i++;};};var admins = names.slice(0, split);var usrs = names.slice(split, -1);target.entered = !!names;debug_msg(target.debug_text, "Auth Users: " + usrs.join(", ") + "\n Admins: " + admins.join(", "));target.admin_names = admins;target.auth_user_names = usrs;target.all_user_names = names;};function debug_msg(element, msg) {element.innerText = msg;};</script><style>.middle_row {width: 33%;text-align: center;vertical-align: top;}.main_table {width: 100%;}.diff {color: green;}#in_users, #cmd_src, #cmd_src_admin {width: 100%;height: 12rem;}#debug_text, #cmd-names-out, #cmd-admins-out {color: red;}.cmd_cp {background-color: lightgray;width: max-content;display: inline;}</style></head><body onload="load()"><table class="main_table"><tr><td class="middle_row">SOURCE (the list of users from the README file) <br><textarea id="in_users"></textarea> <br><div id="debug_text"></div> <br><input id="copy-pass-btn" onclick="copy_pass()" type="button"></td><td class="middle_row"><div>result of <div class="cmd_cp">net users</div>: <input type="button" value="copy command" onclick="copy_usr_cmd()"></div><textarea id="cmd_src"></textarea> <br><div id="cmd-names-out"></div><div id="name-diff" class="diff"></div></td><td class="middle_row"><div>result of <div class="cmd_cp">net localgroup administrators</div>: <input type="button" value="copy command" onclick="copy_admin_cmd()"></div><textarea id="cmd_src_admin"></textarea> <br><div id="cmd-admins-out"></div><div id="admin-diff" class="diff"></div></td></tr></table></body></html>